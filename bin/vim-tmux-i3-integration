#!/bin/bash -ue

# Resize parameter
tmp=/tmp/vim-tmux-i3-integration

focus() {
    i3-msg -q focus $@
}

move() {
    i3-msg -q move $@
}

resize() {
    # Size parameter is not passed from VIM. Use tmp file to pass such parameter.
    # This is to avoid ~/.vimrc having to have i3 size parameter. That is ugly.
    # The tmp file design is not a queue, but store single parameter only. 
    # This may create unwanted side effect when system is extremely busy and having multiple unprocessed commands, but this approach is the most stable.
    if [[ -f $tmp ]]; then
        read size_delta < $tmp
    else # default value. If proper configured, should never reach this path.
        size_delta='10px or 12ppt'
    fi
    i3-msg -q "resize $@ $size_delta"
}

# Ignore commands from VIM if i3 is not the window manager.
if [[ $XDG_CURRENT_DESKTOP == 'i3' ]]; then
    [[ $# == 0 ]] || $@
fi
